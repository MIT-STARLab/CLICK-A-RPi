import fl
handle = FLHandle()
	

# Initialize laser settings
#
#
def laserInit():
    #Set DAC for TEC Controller before turning on power. Otherwise it will burn out the laser
    fl.flWriteChannel(handle,1,3) #Sort out a place to start later
    fl.flWriteChannel(handle,2,3) 
    
    #Turn on TEC Power/LD Controller Power
    fl.flWriteChannel(handle,36,85)

    #Turn on Current Driver Power to drive current
    fl.flWriteChannel(handle,33,85)
    
    #Set Start current at minimum threshold of 30mA
    #Equation for current: 4.096 *1.1(1/6.81+1/16500)*CODE/4096
    #Code = MSB + LSB
    fl.flWriteChannel(handle,3,0)
    fl.flWriteChannel(handle,4,1)


# Set the seed laser current 
# Input units are in uA
#
def setCurrent(code):
    
    MSB_channel = 3 
    LSB_channel = 4

    #Convert uA to byte assignments
    code = setpoint #finish equation
    first_byte = code%256
    second_byte = code/256

    fl.flWriteChannel(handle,MSB_channel,first_byte)      #writes bytes to channel
    fl.flWriteChannel(handle,LSB_channel,second_byte)

def setTemp(code):
    
    MSB_channel = 1 
    LSB_channel = 2

    #Convert uA to byte assignments
    code = setpoint #finish equation
    first_byte = code%256
    second_byte = code/256

    fl.flWriteChannel(handle,MSB_channel,first_byte)      #writes bytes to channel
    fl.flWriteChannel(handle,LSB_channel,second_byte)

#Checks to see if the power switch for the TEC Circuit is on
def checkTECPowerOn():

    if(fl.flReadChannel(handle,36) != 85):
        return False
    else:
        return True

#Checks to see if the power switch for the laser bias Circuit is on
def checkLDPowerOn():
    
    if(fl.flReadChannel(handle,33) != 85):
        return False
    else:
        return True





















